{% extends "base.html" %}
{% block title %}Modify Project{% endblock %}

{% block content %}
<div class="container mt-5">
    <h2 class="mb-4">Edit Project: {{ project.title }}</h2>
    <form method="POST" enctype="multipart/form-data">
        {{ form.hidden_tag() }}

        <div class="form-group">
            {{ form.serial_no.label(class="form-label") }}
            {{ form.serial_no(class="form-control") }}
            {% for error in form.serial_no.errors %}
                <div class="text-danger small">{{ error }}</div>
            {% endfor %}
        </div>

        <div class="form-group">
            {{ form.title.label(class="form-label") }}
            {{ form.title(class="form-control") }}
            {% for error in form.title.errors %}
                <div class="text-danger small">{{ error }}</div>
            {% endfor %}
        </div>

        <div class="form-group">
            {{ form.academia.label(class="form-label") }}
            {{ form.academia(class="form-control") }}
            {% for error in form.academia.errors %}
                <div class="text-danger small">{{ error }}</div>
            {% endfor %}
        </div>

        <div class="form-group">
            {{ form.pi_name.label(class="form-label") }}
            {{ form.pi_name(class="form-control") }}
            {% for error in form.pi_name.errors %}
                <div class="text-danger small">{{ error }}</div>
            {% endfor %}
        </div>

        <div class="form-group">
            {{ form.coord_lab.label(class="form-label") }}
            {{ form.coord_lab(class="form-control") }}
            {% for error in form.coord_lab.errors %}
                <div class="text-danger small">{{ error }}</div>
            {% endfor %}
        </div>

        <div class="form-group">
            {{ form.scientist.label(class="form-label") }}
            {{ form.scientist(class="form-control") }}
            {% for error in form.scientist.errors %}
                <div class="text-danger small">{{ error }}</div>
            {% endfor %}
        </div>

        <div class="form-group">
            {{ form.vertical.label(class="form-label") }}
            {{ form.vertical(class="form-control") }}
            {% for error in form.vertical.errors %}
                <div class="text-danger small">{{ error }}</div>
            {% endfor %}
        </div>

        <div class="form-group">
            {{ form.cost_lakhs.label(class="form-label") }}
            {{ form.cost_lakhs(class="form-control") }}
            {% for error in form.cost_lakhs.errors %}
                <div class="text-danger small">{{ error }}</div>
            {% endfor %}
        </div>

        <div class="form-group">
            {{ form.sanctioned_date.label(class="form-label") }}
            {{ form.sanctioned_date(class="form-control") }}
            {% for error in form.sanctioned_date.errors %}
                <div class="text-danger small">{{ error }}</div>
            {% endfor %}
        </div>

        <div class="form-group">
            {{ form.original_pdc.label(class="form-label") }}
            {{ form.original_pdc(class="form-control") }}
            {% for error in form.original_pdc.errors %}
                <div class="text-danger small">{{ error }}</div>
            {% endfor %}
        </div>

        <div class="form-group">
            {{ form.revised_pdc.label(class="form-label") }}
            {{ form.revised_pdc(class="form-control") }}
            {% for error in form.revised_pdc.errors %}
                <div class="text-danger small">{{ error }}</div>
            {% endfor %}
        </div>

        <div class="form-group">
            {{ form.stakeholders.label(class="form-label") }}
            {{ form.stakeholders(class="form-control") }}
            {% for error in form.stakeholders.errors %}
                <div class="text-danger small">{{ error }}</div>
            {% endfor %}
        </div>

        <div class="mb-3">
            {{ form.scope_objective.label(class="form-label") }}
            {{ form.scope_objective(class="form-control") }}
            {% for error in form.scope_objective.errors %}
                <div class="text-danger small">{{ error }}</div>
            {% endfor %}
        </div>

        <div class="form-group">
            {{ form.expected_deliverables.label(class="form-label") }}
            {{ form.expected_deliverables(class="form-control") }}
            {% for error in form.expected_deliverables.errors %}
                <div class="text-danger small">{{ error }}</div>
            {% endfor %}
        </div>

        <div class="form-group">
            {{ form.Outcome_Dovetailing_with_Ongoing_Work.label(class="form-label") }}
            {{ form.Outcome_Dovetailing_with_Ongoing_Work(class="form-control") }}
            {% for error in form.Outcome_Dovetailing_with_Ongoing_Work.errors %}
              <div class="text-danger small">{{ error }}</div>
            {% endfor %}
          </div>

        <div class="form-group">
            {{ form.rab_meeting_date.label(class="form-label") }}
            {{ form.rab_meeting_date(class="form-control") }}
            {% for error in form.rab_meeting_date.errors %}
                <div class="text-danger small">{{ error }}</div>
            {% endfor %}
        </div>

        <div class="form-group">
            {{ form.rab_meeting_held_date.label(class="form-label") }}
            {{ form.rab_meeting_held_date(class="form-control") }}
            {% for error in form.rab_meeting_held_date.errors %}
                <div class="text-danger small">{{ error }}</div>
            {% endfor %}
        </div>

        <div class="mb-3">
            {{ form.rab_minutes.label(class="form-label") }}
            {{ form.rab_minutes(class="form-control", multiple=True, accept=".pdf") }}
            {% for error in form.rab_minutes.errors %}
                <div class="text-danger small">{{ error }}</div>
            {% endfor %}
            <div class="text-muted mb-2">Upload one or more RAB Minutes of Meeting PDFs.</div>
        </div>
        {% if project.rab_minutes %}
            {% for filename in project.rab_minutes.split(',') %}
                <div>
                <a href="{{ url_for('uploaded_file', filename=filename) }}" target="_blank">{{ filename }}</a>
                <a href="{{ url_for('remove_mom_file', project_id=project.id, mom_type='rab', filename=filename) }}" class="btn btn-danger btn-sm">Remove<br></a>
                </div>
            {% endfor %}
        {% endif %}
      
        <div class="form-group">
            {{ form.gc_meeting_date.label(class="form-label") }}
            {{ form.gc_meeting_date(class="form-control") }}
            {% for error in form.gc_meeting_date.errors %}
                <div class="text-danger small">{{ error }}</div>
            {% endfor %}
        </div>

        <div class="form-group">
            {{ form.gc_meeting_held_date.label(class="form-label") }}
            {{ form.gc_meeting_held_date(class="form-control") }}
            {% for error in form.gc_meeting_held_date.errors %}
                <div class="text-danger small">{{ error }}</div>
            {% endfor %}
        </div>

        <div class="mb-3">
            {{ form.gc_minutes.label(class="form-label") }}
            {{ form.gc_minutes(class="form-control", multiple=True, accept=".pdf") }}
            {% for error in form.gc_minutes.errors %}
                <div class="text-danger small">{{ error }}</div>
            {% endfor %}
            <div class="text-muted mb-2">Upload one or more GC Minutes of Meeting PDFs.</div>
        </div>
        {% if project.gc_minutes %}
            {% for filename in project.gc_minutes.split(',') %}
                <div>
                <a href="{{ url_for('uploaded_file', filename=filename) }}" target="_blank">{{ filename }}</a>
                <a href="{{ url_for('remove_mom_file', project_id=project.id, mom_type='gc', filename=filename) }}" class="btn btn-danger btn-sm">Remove</a>
                </div>
            {% endfor %}
        {% endif %}

        <div class="form-group">
            {{ form.technical_status.label(class="form-label") }}
            {{ form.technical_status(class="form-control") }}
            {% for error in form.technical_status.errors %}
                <div class="text-danger small">{{ error }}</div>
            {% endfor %}
        </div>

        <div class="form-group">
            {{ form.administrative_status.label(class="form-label") }}
            {{ form.administrative_status(class="form-control") }}
            {% for error in form.administrative_status.errors %}
                <div class="text-danger small">{{ error }}</div>
            {% endfor %}
        </div>
        <br>
        <div class="mb-3">
            <label class="form-label">Final Closure Status</label>
            <div class="row">
                <div class="col-md-6">
                    {{ form.final_closure_date.label(class="form-label") }}
                    {{ form.final_closure_date(class="form-control") }}
                    {% for error in form.final_closure_date.errors %}
                        <div class="text-danger small">{{ error }}</div>
                    {% endfor %}
                </div>
                <div class="col-md-6">
                    {{ form.final_closure_remarks.label(class="form-label") }}
                    {{ form.final_closure_remarks(class="form-control") }}
                    {% for error in form.final_closure_remarks.errors %}
                        <div class="text-danger small">{{ error }}</div>
                    {% endfor %}
                </div>
            </div>
        </div>
        
        <div class="mb-3">
            {{ form.final_report.label(class="form-label") }}
            {{ form.final_report(class="form-control", multiple=True, accept=".pdf") }}
            {% for error in form.final_report.errors %}
                <div class="text-danger small">{{ error }}</div>
            {% endfor %}
            <div class="text-muted mb-2">Upload one or more Final Report PDFs.</div>
        </div>
        {% if project.final_report %}
            {% for filename in project.final_report.split(',') %}
                <div>
                <a href="{{ url_for('uploaded_file', filename=filename) }}" target="_blank">{{ filename }}</a>
                <a href="{{ url_for('remove_mom_file', project_id=project.id, mom_type='final_report', filename=filename) }}" class="btn btn-danger btn-sm">Remove</a>
                </div>
            {% endfor %}
        {% endif %}
        
        <button type="submit" class="btn btn-primary mt-3">Update Project</button>
        <a href="{{ url_for('dashboard') }}" class="btn btn-secondary mt-3">Cancel</a>
        <br>
    </form>
</div>
{% endblock %}